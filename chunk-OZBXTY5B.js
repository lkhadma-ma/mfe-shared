import{a as m,b as p,c as s}from"./chunk-2VMXMS7J.js";import{HttpHeaders as X}from"@angular/common/http";import{from as Y}from"rxjs";import{switchMap as l}from"rxjs/operators";import*as f from"@angular/core";import*as M from"@angular/common/http";import{runInInjectionContext as G}from"@angular/core";var I="__NATIVE_FEDERATION__",R=globalThis;R[I]??={externals:new Map,remoteNamesToRemote:new Map,baseUrlToRemoteNames:new Map};var g=R[I],T=g.externals;function N(e){return`${e.packageName}@${e.version}`}function F(e){let t=N(e);return T.get(t)}function O(e,t){let r=N(e);T.set(r,t)}var x=g.remoteNamesToRemote,y=g.baseUrlToRemoteNames;function P(e,t){x.set(e,t),y.set(t.baseUrl,e)}function H(e){return y.get(e)}function C(e){return y.has(e)}function $(e){return x.get(e)}function _(e){document.head.appendChild(Object.assign(document.createElement("script"),{type:"importmap-shim",innerHTML:JSON.stringify(e)}))}function b(e){let t=e.split("/");return t.pop(),t.join("/")}function h(e,t){for(;e.endsWith("/");)e=e.substring(0,e.length-1);return t.startsWith("./")&&(t=t.substring(2,t.length)),`${e}/${t}`}var A=(function(e){return e.COMPLETED="federation-rebuild-complete",e.ERROR="federation-rebuild-error",e})(A||{});function U(e){let t=new EventSource(e);t.onmessage=function(r){JSON.parse(r.data).type===A.COMPLETED&&(console.log("[Federation] Rebuild completed, reloading..."),window.location.reload())},t.onerror=function(r){console.warn("[Federation] SSE connection error:",r)}}function z(e,t){return s(this,null,function*(){let r=b(e),o=yield K(e);t||(t=o.name),o.buildNotificationsEndpoint&&U(r+o.buildNotificationsEndpoint);let n=D(o,t,r);return P(t,p(m({},o),{baseUrl:r})),n})}function D(e,t,r){let o=W(e,t,r),n=V(e,r);return{imports:o,scopes:n}}function K(e){return s(this,null,function*(){return yield fetch(e).then(r=>r.json())})}function V(e,t){let r={},o={};for(let n of e.shared){let i=F(n)??h(t,n.outFileName);O(n,i),o[n.packageName]=i}return r[t+"/"]=o,r}function W(e,t,r){let o={};for(let n of e.exposes){let i=h(t,n.key),a=h(r,n.outFileName);o[i]=a}return o}function S(e,t){return s(this,null,function*(){let r=J(e,t);yield B(r);let o=q(r),n=$(o),i=r.fallback,a=n?"":"unknown remote "+o;if(!n&&!i)throw new Error(a);if(!n)return v(a),Promise.resolve(i);let d=n.exposes.find(u=>u.key===r.exposedModule),E=d?"":`Unknown exposed module ${r.exposedModule} in remote ${o}`;if(!d&&!i)throw new Error(E);if(!d)return v(E),Promise.resolve(i);let k=h(n.baseUrl,d.outFileName);try{return L(k)}catch(u){if(i)return console.error("error loading remote module",u),i;throw u}})}function L(e){return typeof importShim<"u"?importShim(e):import(e)}function q(e){let t;if(e.remoteName)t=e.remoteName;else if(e.remoteEntry){let r=b(e.remoteEntry);t=H(r)}else throw new Error("unexpcted arguments: Please pass remoteName or remoteEntry");if(!t)throw new Error("unknown remoteName "+t);return t}function B(e){return s(this,null,function*(){if(e.remoteEntry&&!C(b(e.remoteEntry))){let t=yield z(e.remoteEntry);_(t)}})}function J(e,t){let r;if(typeof e=="string"&&t)r={remoteName:e,exposedModule:t};else if(typeof e=="object"&&!t)r=e;else throw new Error("unexpected arguments: please pass options or a remoteName/exposedModule-pair");return r}function v(e){typeof window<"u"&&console.error(e)}import*as c from"@angular/core";var w=class e{constructor(t){this.injector=t}remote;readyPromise;initRemote(){return this.readyPromise||(this.readyPromise=s(this,null,function*(){let t=yield S({remoteName:"auth",exposedModule:"./AuthService"});return this.remote=G(this.injector,()=>new t.AuthService),this.remote})),this.readyPromise}authorizationHeader(t=200,r=10){return s(this,null,function*(){let o=yield this.initRemote(),n,i=0;do{if(n=yield o.authorizationHeader(),n)break;if(i++,i>=r)throw new Error("Auth header not ready after max retries");yield new Promise(a=>setTimeout(a,t))}while(!n);return n})}static \u0275fac=function(r){return new(r||e)(c.\u0275\u0275inject(c.EnvironmentInjector))};static \u0275prov=c.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"})};var j=class e{constructor(t,r){this.http=t;this.auth=r}withAuthHeaders(t){return Y(this.auth.authorizationHeader()).pipe(l(r=>{let o=new X(p(m({},t?.headers??{}),{Authorization:r}));return[p(m({},t),{headers:o})]}))}get(t,r){return this.withAuthHeaders(r).pipe(l(o=>this.http.get(t,o)))}post(t,r,o){return this.withAuthHeaders(o).pipe(l(n=>this.http.post(t,r,n)))}put(t,r,o){return this.withAuthHeaders(o).pipe(l(n=>this.http.put(t,r,n)))}delete(t,r){return this.withAuthHeaders(r).pipe(l(o=>this.http.delete(t,o)))}static \u0275fac=function(r){return new(r||e)(f.\u0275\u0275inject(M.HttpClient),f.\u0275\u0275inject(w))};static \u0275prov=f.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"})};export{j as a};
